name: deploy
on: [push]

jobs:
    build:
        name: Hexo Generation
        runs-on: ubuntu-latest

        strategy:
            matrix:
                node-version: [12.x]
        steps:
            - uses: actions/checkout@v2
            - uses: actions/setup-node@v1
            - run: yarn --frozen-lockfile
            - name: Hexo Generation
              run: yarn build
              id: hexog
            - name: Copy SSH keys
              run: |
                mkdir ~/.ssh
                echo "${{ secrets.SCP_KEY }}" > ~/.ssh/id_rsa
                chmod 600 ~/.ssh/id_rsa
            - name: Clean remote public
              run: ssh rm -rf /www/public
            - run: scp -r ./public/ root@laizn.com:/www/
            - name: Clean SSH keys
              run: rm -rf ~/.ssh